<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8" />
  <title>Crear/Editar Producto</title>
  <link rel="stylesheet" href="../css/global.css" />
  <link rel="stylesheet" href="../css/navbar.css" />
  <link rel="stylesheet" href="../css/productos.css" />
</head>
<body>
  <div class="container">
    <aside id="sidebar-placeholder" class="sidebar"></aside>

    <main class="main-content">
      <header class="main-header">
        <h2 id="form-titulo">Cargando...</h2>
        <div class="header-actions">
          <a href="productos.html" class="btn btn-secundario">‚Üê Volver a la Lista</a>
        </div>
      </header>

      <section class="content-body">
        <form id="producto-form" class="form-container">
          <input type="hidden" id="producto-id" />

          <div class="form-grid-2">
            <div class="form-campo">
              <label for="nombre">Nombre del Producto</label>
              <input type="text" id="nombre" required />
            </div>
            <div class="form-campo">
              <label for="codigo_barras">C√≥digo de Barras</label>
              <input type="text" id="codigo_barras" />
            </div>
          </div>

          <!-- üîπ NUEVO: Secci√≥n Balanza / PLU -->
          <div class="form-grid-2">
            <div class="form-campo">
              <label>
                <input type="checkbox" id="pesable" />
                Producto pesable (balanza)
              </label>
              <small>Si est√° activo, se aplicar√° la estrategia de PLU de Admin ‚Üí Balanza.</small>
            </div>
            <div class="form-campo" id="plu-row" style="display:none;">
              <label for="plu">PLU (balanza)</label>
              <input type="text" id="plu" inputmode="numeric" />
              <small id="plu-help"></small>
            </div>
          </div>

          <fieldset>
            <legend>Clasificaci√≥n (Opcional)</legend>
            <div class="form-grid-2">
              <div class="form-campo-vertical">
                <div class="form-campo-con-boton">
                  <select id="departamento-select"></select>
                  <button type="button" id="btn-nuevo-depto" class="btn btn-info btn-add" title="Crear departamento">+</button>
                </div>
                <div id="nuevo-depto-container" class="inline-form-container" style="display:none;">
                  <input type="text" id="nuevo-depto-nombre" placeholder="Nombre del nuevo depto..." />
                  <button type="button" id="btn-guardar-depto" class="btn btn-success btn-sm">‚úî</button>
                  <button type="button" id="btn-cancelar-depto" class="btn btn-danger btn-sm">‚úñ</button>
                </div>
              </div>

              <div class="form-campo-vertical">
                <div class="form-campo-con-boton">
                  <select id="familia-select" disabled></select>
                  <button type="button" id="btn-nueva-familia" class="btn btn-info btn-add" title="Crear familia">+</button>
                </div>
                <div id="nueva-familia-container" class="inline-form-container" style="display:none;">
                  <input type="text" id="nueva-familia-nombre" placeholder="Nombre de la nueva familia..." />
                  <button type="button" id="btn-guardar-familia" class="btn btn-success btn-sm">‚úî</button>
                  <button type="button" id="btn-cancelar-familia" class="btn btn-danger btn-sm">‚úñ</button>
                </div>
              </div>
            </div>
          </fieldset>

          <div class="form-grid-2">
            <fieldset>
              <legend>Inventario</legend>
              <div class="form-grid-2">
                <div class="form-campo">
                  <label for="stock">Stock</label>
                  <input type="number" id="stock" step="any" value="0" />
                </div>
                <div class="form-campo">
                  <label for="unidad">Unidad (kg, u)</label>
                  <input type="text" id="unidad" placeholder="ej: kg, u, L" value="unidad" />
                </div>
              </div>
              <div class="form-campo">
                <label for="fecha_vencimiento">Fecha Vencimiento (Opcional)</label>
                <input type="date" id="fecha_vencimiento" />
              </div>
            </fieldset>

            <fieldset>
              <legend>Precios</legend>
              <div class="form-grid-2">
                <div class="form-campo">
                  <label for="precioCompra">Precio Compra</label>
                  <input type="number" id="precioCompra" step="0.01" value="0" />
                </div>
                <div class="form-campo">
                  <label for="precioVenta">Precio Venta</label>
                  <input type="number" id="precioVenta" step="0.01" value="0" />
                </div>
              </div>
              <div class="rentabilidad-box">
                <span>Ganancia: <strong id="ganancia-unidad">$0.00</strong></span>
                <span>Margen: <strong id="margen-ganancia">0%</strong></span>
              </div>
            </fieldset>
          </div>

          <div class="form-campo form-campo-imagen-container">
            <label for="imagen_producto">Foto del Producto (Opcional)</label>
            <input type="file" id="imagen_producto" accept="image/*" />
            <img id="imagen-preview" src="#" alt="Previsualizaci√≥n" class="imagen-preview-oculta" />
          </div>

          <div class="form-acciones">
            <a href="productos.html" class="btn btn-secundario">Cancelar</a>
            <button type="submit" id="btn-guardar-producto" class="btn btn-primario">Guardar Producto</button>
          </div>
        </form>
      </section>
    </main>
  </div>

  <script defer src="../js/navbar-loader.js"></script>
  <script defer src="../js/producto-form.js"></script>

  <!-- Toast -->
  <div id="toast-notification" class="toast"></div>
</body>
</html>
